<!DOCTYPE html>
<html lang="ht">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editeur Foto ak Videyo Senp nan Navigatè</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        #container {
            width: 100%;
            max-width: 1200px;
            padding: 20px;
            box-sizing: border-box;
        }
        #upload-section, #edit-section {
            margin-bottom: 20px;
            width: 100%;
        }
        #preview {
            width: 100%;
            max-height: 400px;
            border: 1px solid #ccc;
            background-color: #fff;
        }
        button, input {
            margin: 5px;
            padding: 10px;
            font-size: 16px;
        }
        #text-input, #filter-select {
            width: 200px;
        }
        /* Responsive design */
        @media (max-width: 768px) {
            button, input {
                width: 100%;
                margin: 10px 0;
            }
            #preview {
                max-height: 300px;
            }
        }
        @media (max-width: 480px) {
            #container {
                padding: 10px;
            }
            #preview {
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div id="container">
        <h1>Editeur Foto ak Videyo Senp (San Backend)</h1>
        <p>Sa se yon egzanp senp ki ka edite foto oswa videyo nan navigatè a. Li ka fè edisyon debaz tankou koupe videyo, ajoute tèks, aplike filtè senp, ak ekspòte. Limite pa resous navigatè a.</p>
        
        <div id="upload-section">
            <input type="file" id="file-input" accept="image/*,video/*">
            <button onclick="loadMedia()">Chaje Medya</button>
        </div>
        
        <div id="edit-section" style="display: none;">
            <video id="video-preview" controls style="display: none; width: 100%;"></video>
            <canvas id="canvas-preview" style="display: none; width: 100%;"></canvas>
            
            <!-- Pou videyo: Koupe -->
            <div id="video-controls" style="display: none;">
                <label>Debut (segond): <input type="number" id="start-time" value="0" min="0"></label>
                <label>Fin (segond): <input type="number" id="end-time" value="10" min="1"></label>
                <button onclick="trimVideo()">Koupe Videyo</button>
            </div>
            
            <!-- Pou foto/videyo: Ajoute tèks -->
            <label>Tèks: <input type="text" id="text-input" placeholder="Ajoute tèks"></label>
            <button onclick="addText()">Ajoute Tèks</button>
            
            <!-- Filtè senp -->
            <label>Filtè: 
                <select id="filter-select">
                    <option value="none">Pa genyen</option>
                    <option value="grayscale">Grayscale</option>
                    <option value="sepia">Sepia</option>
                    <option value="invert">Invert</option>
                </select>
            </label>
            <button onclick="applyFilter()">Aplike Filtè</button>
            
            <button onclick="exportMedia()">Ekspòte</button>
        </div>
    </div>

    <script>
        let mediaType = null; // 'image' oswa 'video'
        let originalMedia = null; // URL oswa blob
        let canvas = document.getElementById('canvas-preview');
        let ctx = canvas.getContext('2d');
        let video = document.getElementById('video-preview');
        let editedBlob = null;

        function loadMedia() {
            const file = document.getElementById('file-input').files[0];
            if (!file) return alert('Chwazi yon fichye');
            
            originalMedia = URL.createObjectURL(file);
            mediaType = file.type.startsWith('video') ? 'video' : 'image';
            
            document.getElementById('edit-section').style.display = 'block';
            
            if (mediaType === 'video') {
                video.src = originalMedia;
                video.style.display = 'block';
                canvas.style.display = 'none';
                document.getElementById('video-controls').style.display = 'block';
                video.onloadedmetadata = () => {
                    document.getElementById('end-time').max = video.duration;
                    document.getElementById('end-time').value = video.duration;
                };
            } else {
                const img = new Image();
                img.src = originalMedia;
                img.onload = () => {
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    canvas.style.display = 'block';
                    video.style.display = 'none';
                    document.getElementById('video-controls').style.display = 'none';
                };
            }
        }

        function trimVideo() {
            const start = parseFloat(document.getElementById('start-time').value);
            const end = parseFloat(document.getElementById('end-time').value);
            if (start >= end || start < 0 || end > video.duration) return alert('Tan envalid');
            
            // Itilize MediaRecorder pou koupe (senp, men pa pafè)
            video.currentTime = start;
            video.play();
            const chunks = [];
            const stream = video.captureStream();
            const recorder = new MediaRecorder(stream);
            recorder.ondataavailable = e => chunks.push(e.data);
            recorder.onstop = () => {
                editedBlob = new Blob(chunks, { type: 'video/mp4' });
                video.src = URL.createObjectURL(editedBlob);
            };
            recorder.start();
            setTimeout(() => {
                recorder.stop();
                video.pause();
            }, (end - start) * 1000);
        }

        function addText() {
            const text = document.getElementById('text-input').value;
            if (!text) return;
            
            if (mediaType === 'image') {
                ctx.font = '30px Arial';
                ctx.fillStyle = 'red';
                ctx.fillText(text, 50, 50);
            } else {
                alert('Ajoute tèks sou videyo egzije plis konplèksite; sa se senp egzanp.');
            }
        }

        function applyFilter() {
            const filter = document.getElementById('filter-select').value;
            if (mediaType === 'image') {
                const img = new Image();
                img.src = originalMedia;
                img.onload = () => {
                    canvas.width = img.width;
                    canvas.height = img.height;
                    ctx.drawImage(img, 0, 0);
                    ctx.filter = filter;
                    ctx.drawImage(canvas, 0, 0); // Re-desen pou aplike filtè
                };
            } else {
                video.style.filter = filter === 'none' ? '' : filter + '(100%)';
            }
        }

        function exportMedia() {
            if (mediaType === 'image') {
                canvas.toBlob(blob => {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = 'edited-image.png';
                    a.click();
                });
            } else if (editedBlob) {
                const url = URL.createObjectURL(editedBlob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'edited-video.mp4';
                a.click();
            } else {
                alert('Fè edisyon anvan ekspòte');
            }
        }
    </script>
</body>
</html>
